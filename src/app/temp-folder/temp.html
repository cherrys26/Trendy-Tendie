<!-- Good-sentiment html  -->

<ion-content>
    <ion-segment [(ngModel)]="segmentSelected">
        <ion-segment-button value="Stocks">
            <ion-label>Stonks</ion-label>
        </ion-segment-button>
        <ion-segment-button value="Crypto">
            <ion-label>Crypto</ion-label>
        </ion-segment-button>
    </ion-segment>


    <div [ngSwitch]="segmentSelected">

        <div *ngSwitchCase="'Stocks'">
            <ion-segment scrollable [(ngModel)]="stockTime">
                <ion-segment-button value="oneDay">
                    <ion-label>1D</ion-label>
                </ion-segment-button>
                <ion-segment-button value="oneWeek">
                    <ion-label>1W</ion-label>
                </ion-segment-button>
                <ion-segment-button value="oneMonth">
                    <ion-label>1M</ion-label>
                </ion-segment-button>
                <ion-segment-button value="threeMonth">
                    <ion-label>3M</ion-label>
                </ion-segment-button>
                <ion-segment-button value="oneYear">
                    <ion-label>1Y</ion-label>
                </ion-segment-button>
                <ion-segment-button value="threeYear">
                    <ion-label>3Y</ion-label>
                </ion-segment-button>
                <ion-segment-button value="allTime">
                    <ion-label>All</ion-label>
                </ion-segment-button>
            </ion-segment>
            <div [ngSwitch]="stockTime">
                <ion-note>
                    <h5 style="text-align: right; font-size: 10px; padding-top:5px; padding-bottom: 0; margin: 0;">
                        *press stock
                        to
                        filter out*</h5>
                </ion-note>
                <div *ngSwitchCase="'oneDay'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'oneWeek'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'oneMonth'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'threeMonth'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'sixMonth'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'oneYear'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'threeYear'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'allTime'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
            </div>
        </div>

        <div *ngSwitchCase="'Crypto'">

            <ion-segment scrollable [(ngModel)]="stockTime">
                <ion-segment-button value="oneDay">
                    <ion-label>1D</ion-label>
                </ion-segment-button>
                <ion-segment-button value="oneWeek">
                    <ion-label>1W</ion-label>
                </ion-segment-button>
                <ion-segment-button value="oneMonth">
                    <ion-label>1M</ion-label>
                </ion-segment-button>
                <ion-segment-button value="threeMonth">
                    <ion-label>3M</ion-label>
                </ion-segment-button>
                <ion-segment-button value="oneYear">
                    <ion-label>1Y</ion-label>
                </ion-segment-button>
                <ion-segment-button value="threeYear">
                    <ion-label>3Y</ion-label>
                </ion-segment-button>
                <ion-segment-button value="allTime">
                    <ion-label>All</ion-label>
                </ion-segment-button>
            </ion-segment>
            <div [ngSwitch]="stockTime">
                <ion-note>
                    <h5 style="text-align: right; font-size: 10px; padding-top:5px; padding-bottom: 0; margin: 0;">
                        *press stock
                        to
                        filter out*</h5>
                </ion-note>
                <div *ngSwitchCase="'oneDay'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'oneWeek'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'oneMonth'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'threeMonth'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'sixMonth'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'oneYear'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'threeYear'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
                <div *ngSwitchCase="'allTime'">
                    <canvas baseChart [datasets]="chartData" [labels]="chartLabels" [chartType]="chartType"
                        [colors]="chartColors">
                    </canvas>
                </div>
            </div>
        </div>
    </div>
</ion-content>

<!-- good-sentiment ts -->
import { HttpClient } from '@angular/common/http';
import { Component, OnInit } from '@angular/core';
import { NavController, Platform } from '@ionic/angular';
import { ChartDataSets } from 'chart.js';
import { Color, Label } from 'ng2-charts';

import { ScreenOrientation } from '@ionic-native/screen-orientation/ngx';


@Component({
selector: 'app-good-sentiment',
templateUrl: './good-sentiment.page.html',
styleUrls: ['./good-sentiment.page.scss'],
})
export class GoodSentimentPage implements OnInit {

//Data
chartData: ChartDataSets[] = [
{ data: [], label: 'AAPL' },
{ data: [50, 60, 70, 80, 90, 100, 120, 130, 40, 80], label: 'Test' },
];
chartLabels: Label[];

//chart options

chartOptions = {
responsive: true,
title: {
display: true,
text: 'historical closing price'
},
pan: {
enabled: true,
mode: 'xy'
},
zoom: {
enabled: true,
mode: 'xy'
}
};

chartColors: Color[] = [
{
borderColor: '#000000',
}
];

chartType = 'line';
showLegend = false;

//for Search on chart
stock = 'AAPL'

segmentSelected = "Stocks";
stockTime = "oneDay";


constructor(public platform: Platform,
public navCtrl: NavController,
private http: HttpClient,
public screenOrientation: ScreenOrientation) {
console.log(this.screenOrientation.type);
this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.LANDSCAPE);
console.log(this.screenOrientation.type);
}


ngOnInit() {
this.getData();

}

getData() {
this.http.get(`https://financialmodelingprep.com/api/v3/historical-price-full/${this.stock}?from=2020-03-12&to=2020-08-12&apikey=demo`)
.subscribe(res => {
console.log('Res: ', res);
const history = res['historical'];

this.chartData[0].data = [];

this.chartLabels = [];

for (let entry of history) {
this.chartLabels.push(entry.date);
this.chartData[0].data.push(entry['close']);
}
console.log('data:', this.chartData);
console.log('data:', this.chartLabels);
});
}
public devWidth = this.platform.width();


}